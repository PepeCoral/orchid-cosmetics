{% extends 'admin/base_admin.html' %}

{% block content %}

<h2 class="mb-4">Lista de Pedidos</h2>

<div class="container-fluid">

    <div class="row">
        <div class="col-12 col-lg-10 mx-auto">

            {% for order in ordenes %}

            <div class="card shadow-sm order-card p-4 mb-4">

                <!-- Título -->
                <h4 class="mb-3 font-weight-bold">Pedido #{{ order.identifier }}</h4>

                <!-- Usuario -->
                <p class="mb-2">
                    <strong>Usuario:</strong>
                    {% if order.user %}
                        <span>{{ order.user }}</span>
                    {% else %}
                        <span class="text-muted">Anónimo</span>
                    {% endif %}
                </p>

                <!-- Método de pago -->
                <p class="mb-2">
                    <strong>Método de pago:</strong>
                    <span class="badge badge-payment">{{ order.pay_method }}</span>
                </p>

                <!-- Dirección -->
                <p class="mb-2">
                    <strong>Dirección:</strong> {{ order.address }}
                </p>

                <!-- Estado -->
                <p class="mb-2">
                    <strong>Estado:</strong>
                    {% if order.status == "pending" %}
                        <span class="badge badge-warning">Pendiente</span>
                    {% elif order.status == "shipped" %}
                        <span class="badge badge-primary">Enviado</span>
                    {% else %}
                        <span class="badge badge-success">Entregado</span>
                    {% endif %}
                </p>

                <hr>

                <!-- Botones -->
                <div class="d-flex justify-content-between align-items-center">

                    <div>
                        {% if order.status == "pending" %}
                            <form method="post" action="{% url 'admin/orders/ship' order.id %}" class="d-inline">
                                {% csrf_token %}
                                <button class="btn btn-sm btn-purple">Marcar como enviado</button>
                            </form>

                        {% elif order.status == "shipped" %}
                            <form method="post" action="{% url 'admin/orders/deliver' order.id %}" class="d-inline">
                                {% csrf_token %}
                                <button class="btn btn-sm btn-purple">Marcar como entregado</button>
                            </form>
                        {% endif %}
                    </div>

                    <a href="{% url 'admin/orders/items' order.id %}" 
                       class="btn btn-sm btn-outline-info view-btn">
                       Ver detalles
                    </a>

                </div>

            </div>

            {% endfor %}

        </div>
    </div>

</div>

<!-- ESTILOS MODERNOS -->
<style>
    .order-card {
        border-radius: 14px;
        transition: transform .15s ease, box-shadow .15s ease;
    }

    .order-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }

    .badge-payment {
        background-color: #d9d9d9;
        color: #333;
        padding: 6px 10px;
        border-radius: 6px;
        font-weight: 500;
    }

    .btn-purple {
        background-color: #6f42c1;
        color: white;
        border-radius: 8px;
        padding: 6px 12px;
        transition: .2s ease;
    }

    .btn-purple:hover {
        background-color: #5a34a0;
        color: white;
    }

    .view-btn {
        border-radius: 8px;
        padding: 6px 14px;
        font-weight: 500;
    }
</style>

{% endblock %}
