<button class="btn text-white mb-3" type="button" data-toggle="collapse" data-target="#searchForm"
      aria-expanded="false" aria-controls="searchForm" style="background-color: #6f42c1;">
      Buscar y Filtrar
    </button>
  <div class="collapse" id="searchForm">
      <div class="card card-body shadow-sm">
        {% if type == 'product' %}
          <form method="POST" class="row g-3">
        {% elif type == 'service' %}
          <form method="POST" class="row g-3">
        {% endif %}
          
        {% csrf_token %}
        
        {% if type == 'product' %}
        <div class="col-md-6">
          <label for="{{ form.name.id_for_label }}" class="form-label">{{ form.name.label }}</label>
          {{ form.name }}
        </div>

        <div class="col-md-6">
          <label for="{{ form.fabricator.id_for_label }}" class="form-label">{{ form.fabricator.label }}</label>
          {{ form.fabricator }}
        </div>

        <div class="col-md-3">
          <label for="{{ form.min_price.id_for_label }}" class="form-label">{{ form.min_price.label }}</label>
          {{ form.min_price }}
        </div>

        <div class="col-md-3">
          <label for="{{ form.max_price.id_for_label }}" class="form-label">{{ form.max_price.label }}</label>
          {{ form.max_price }}
        </div>

        <div class="col-12">
          <label for="{{ form.categories.id_for_label }}" class="form-label">{{ form.categories.label }}</label>
          {{ form.categories }}
        </div>

        {% elif type == 'service' %}
        <div class="col-md-6">
          <label for="{{ form.name.id_for_label }}" class="form-label">{{ form.name.label }}</label>
          {{ form.name }}
        </div>

        <div class="col-md-6">
          <label for="{{ form.department.id_for_label }}" class="form-label">{{ form.department.label }}</label>
          {{ form.department }}
        </div>

        <div class="col-md-3">
          <label for="{{ form.min_price.id_for_label }}" class="form-label">{{ form.min_price.label }}</label>
          {{ form.min_price }}
        </div>

        <div class="col-md-3">
          <label for="{{ form.max_price.id_for_label }}" class="form-label">{{ form.max_price.label }}</label>
          {{ form.max_price }}
        </div>

        <div class="col-12">
          <label for="{{ form.categories.id_for_label }}" class="form-label">{{ form.categories.label }}</label>
          {{ form.categories }}
        </div>
{% endif %}
      <div class="col-12">
          <div class="d-flex">
              <button type="submit" class="btn text-white mr-2" style="background-color: #6f42c1;">
                Aplicar Filtros
              </button>
            {% if type == 'product' %}
                <a href="{% url 'product_catalog' %}" class="btn btn-outline-secondary">
            {% elif type == 'service' %}
                <a href="{% url 'service_catalog' %}" class="btn btn-outline-secondary">
            {% endif %}
              Limpiar Filtros
            </a>
          </div>
        </div>
</form>
      </div>
    </div>
{% if type == 'product' %}
    <!-- Mostrar filtros activos -->
  {% if form.is_bound %}
  <div class="mb-3">
    <small class="text-muted">
      Filtros activos:
      {% if form.name.value %}
      <span class="badge bg-filter">Nombre: "{{ form.name.value }}"</span>
      {% endif %}
      {% if form.fabricator.value %}
      <span class="badge bg-filter">Fabricante: "{{ form.fabricator.value }}"</span>
      {% endif %}
      {% if form.min_price.value %}
      <span class="badge bg-filter">Precio mínimo: {{ form.min_price.value }}€</span>
      {% endif %}
      {% if form.max_price.value %}
      <span class="badge bg-filter">Precio máximo: {{ form.max_price.value }}€</span>
      {% endif %}
      {% if form.categories.value %}
      <span class="badge bg-filter">{{ form.categories.value|length }} categoría(s)</span>
      {% endif %}
    </small>
  </div>
  {% endif %}

  <hr>
{% elif type == 'service' %}
  {% if form.is_bound %}
  <div class="mb-3">
    <small class="text-muted">
      Filtros activos:
      {% if form.name.value %}
      <span class="badge bg-filter">Nombre: "{{ form.name.value }}"</span>
      {% endif %}
      {% if form.department.value %}
      <span class="badge bg-filter">Departamento: "{{ form.department.value }}"</span>
      {% endif %}
      {% if form.min_price.value %}
      <span class="badge bg-filter">Precio mínimo: {{ form.min_price.value }}€</span>
      {% endif %}
      {% if form.max_price.value %}
      <span class="badge bg-filter">Precio máximo: {{ form.max_price.value }}€</span>
      {% endif %}
      {% if form.categories.value %}
      <span class="badge bg-filter">{{ form.categories.value|length }} categoría(s)</span>
      {% endif %}
    </small>
  </div>
  {% endif %}

  <hr>
{% endif %}

<style>

    .badge.bg-filter {
    background-color: #6f42c1 !important;
    color: #fff !important;
    font-weight: 500;
    margin-right: 5px;
    margin-bottom: 3px;
  }

</style>